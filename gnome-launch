#!/usr/bin/env python

# Thanks to Aleksandar Jovanov:
# <http://aleksandarjovanov.blogspot.com/2012/10/having-fun-with-gnome-shell.html>

import json
import os
import sys

import dbus

def main(argv):
 if len(argv) != 2:
  print >> sys.stderr, "Usage: %s desktop-file" % argv[0]
  return 2
 
 gnome_shell_launch(os.path.expanduser(argv[1]))

def gnome_shell_launch(desktop_file):
 gnome_shell_exec("Shell.AppSystem.get_default().lookup_app_for_path(%s).launch(0,[],-1)"
                  % json.dumps(desktop_file))

def gnome_shell_exec(js):
 bus = dbus.SessionBus()
 proxy = bus.get_object("org.gnome.Shell", "/org/gnome/Shell")
 proxy.Eval(js, dbus_interface="org.gnome.Shell")

if __name__ == "__main__":
 sys.exit(main(sys.argv))
